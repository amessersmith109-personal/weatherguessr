<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ¤ï¸ Weatherguessr - US Weather Geography Game</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸŒ¤ï¸</text></svg>">
</head>
<body>
    <!-- Username Input Screen -->
    <div id="usernameScreen" class="screen active">
        <div class="container">
            <div class="logo">
                <h1>ğŸŒ¤ï¸ Weatherguessr</h1>
                <p>Match US states to weather categories!</p>
            </div>
            
            <div class="username-form">
                <h2>Enter Your Username</h2>
                <input type="text" id="usernameInput" placeholder="Your username" maxlength="20">
                <button id="continueBtn" class="btn btn-primary">Continue</button>
            </div>
            
            <div class="instructions">
                <h3>How to Play:</h3>
                <ul>
                    <li>Roll for a random US state</li>
                    <li>Choose which weather category it ranks highest in</li>
                    <li>Get points based on ranking (lower = better)</li>
                    <li>Complete all 8 categories to finish</li>
                    <li>Try to get the lowest total score!</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Main Menu Screen -->
    <div id="mainMenuScreen" class="screen">
        <div class="container">
            <div class="logo">
                <h1>ğŸŒ¤ï¸ Weatherguessr</h1>
                <p>Welcome, <span id="welcomeUsername">Player</span>!</p>
            </div>
            
            <div class="main-menu">
                <div class="menu-options">
                    <button id="singlePlayerBtn" class="btn btn-primary btn-large menu-btn">
                        ğŸ¯ Single Player
                    </button>
                    <button id="multiplayerBtn" class="btn btn-primary btn-large menu-btn">
                        ğŸ® Multiplayer
                    </button>
                    <button id="leaderboardBtn" class="btn btn-secondary btn-large menu-btn">
                        ğŸ† Global Leaderboard
                    </button>
                </div>
                
                <div class="menu-footer">
                    <button id="changeUsernameBtn" class="btn btn-secondary">Change Username</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Game Screen -->
    <div id="gameScreen" class="screen">
        <div class="header">
            <div class="user-info">
                <span id="currentUser"></span>
                <span id="bestScore"></span>
            </div>
            <div class="game-controls">
                <button id="resetBtn" class="btn btn-secondary">Reset Round</button>
                <button id="newGameBtn" class="btn btn-secondary">New Game</button>
            </div>
        </div>

        <div class="game-container">
            <!-- Current State Display -->
            <div class="state-display">
                <div id="stateFlag" class="state-flag">ğŸŒ¤ï¸</div>
                <div id="stateName" class="state-name">Click "Roll" to start!</div>
            </div>

            <!-- Roll Button -->
            <div class="roll-section">
                <button id="rollBtn" class="btn btn-primary btn-large">ğŸ² Roll for State</button>
            </div>

            <!-- Categories Grid -->
            <div class="categories-grid">
                <div class="category" data-category="tornados">
                    <div class="category-icon">ğŸŒªï¸</div>
                    <div class="category-name">Tornados (Yearly Avg)</div>
                    <div class="category-score">-</div>
                </div>
                <div class="category" data-category="rainfall">
                    <div class="category-icon">ğŸŒ§ï¸</div>
                    <div class="category-name">Rainfall (Yearly Avg)</div>
                    <div class="category-score">-</div>
                </div>
                <div class="category" data-category="highestTemp">
                    <div class="category-icon">ğŸ”¥</div>
                    <div class="category-name">Highest Temp (Historic)</div>
                    <div class="category-score">-</div>
                </div>
                <div class="category" data-category="lowestTemp">
                    <div class="category-icon">â„ï¸</div>
                    <div class="category-name">Lowest Temp (Historic)</div>
                    <div class="category-score">-</div>
                </div>
                <div class="category" data-category="sunshine">
                    <div class="category-icon">â˜€ï¸</div>
                    <div class="category-name">Sunshine (Yearly Avg)</div>
                    <div class="category-score">-</div>
                </div>
                <div class="category" data-category="wind">
                    <div class="category-icon">ğŸ’¨</div>
                    <div class="category-name">Wind (Yearly Avg)</div>
                    <div class="category-score">-</div>
                </div>
                <div class="category" data-category="snowfall">
                    <div class="category-icon">ğŸŒ¨ï¸</div>
                    <div class="category-name">Snowfall (Yearly Avg)</div>
                    <div class="category-score">-</div>
                </div>
                <div class="category" data-category="lightning">
                    <div class="category-icon">âš¡</div>
                    <div class="category-name">Lightning (Yearly Avg)</div>
                    <div class="category-score">-</div>
                </div>
            </div>

            <!-- Score Display -->
            <div class="score-section">
                <div class="current-score">
                    <span>Current Score: </span>
                    <span id="currentScore">0</span>
                </div>
                <div class="categories-left">
                    <span>Categories Left: </span>
                    <span id="categoriesLeft">8</span>
                </div>
            </div>
        </div>

        <!-- Game Over Modal -->
        <div id="gameOverModal" class="modal">
            <div class="modal-content">
                <h2>ğŸ‰ Round Complete!</h2>
                <div class="final-score">
                    <span>Final Score: </span>
                    <span id="finalScore">0</span>
                </div>
                <div id="newRecord" class="new-record" style="display: none;">
                    ğŸ† New Best Score! ğŸ†
                </div>
                <div class="modal-buttons">
                    <button id="playAgainBtn" class="btn btn-primary">Play Again</button>
                    <button id="mainMenuBtn" class="btn btn-secondary">Main Menu</button>
                </div>
            </div>
        </div>

    </div>

    <!-- Multiplayer Lobby Screen -->
    <div id="multiplayerScreen" class="screen">
        <div class="container">
            <div class="header">
                <h1>ğŸ® Multiplayer Lobby</h1>
                <button id="backToMainBtn" class="btn btn-secondary">â† Back to Main</button>
            </div>
            
            <div class="lobby-content">
                <div class="online-players-section">
                    <h2 id="onlinePlayersHeader">ğŸ‘¥ Online Players</h2>
                    <div id="onlinePlayersList" class="players-list">
                        <p>Loading online players...</p>
                    </div>
                    <button id="refreshPlayersBtn" class="btn btn-secondary">ğŸ”„ Refresh</button>
                </div>
                
                <div class="invitations-section">
                    <h2 id="invitationsHeader">ğŸ“¨ Invitations</h2>
                    <div id="invitationsList" class="invitations-list">
                        <p>No pending invitations</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Multiplayer Game Screen -->
    <div id="multiplayerGameScreen" class="screen">
        <div class="multiplayer-header">
            <div class="match-info">
                <h2>ğŸ¯ Best of 7 Series</h2>
                <div class="score-display">
                    <span id="player1Score">0</span> - <span id="player2Score">0</span>
                </div>
                <div class="round-info">
                    Round <span id="currentRound">1</span> of 7
                </div>
            </div>
            <button id="leaveGameBtn" class="btn btn-secondary">Leave Game</button>
        </div>
        
        <div class="split-screen">
            <div class="player-side" id="player1Side">
                <div class="player-header">
                    <h3 id="player1Name">Player 1</h3>
                    <div class="player-status" id="player1Status">Waiting...</div>
                </div>
                <div class="player-game-area">
                    <div class="state-display">
                        <div id="player1StateFlag" class="state-flag">ğŸŒ¤ï¸</div>
                        <div id="player1StateName" class="state-name">Waiting for roll...</div>
                    </div>
                    <div class="roll-section">
                        <button id="player1RollBtn" class="btn btn-primary btn-large" disabled>ğŸ² Roll for State</button>
                    </div>
                    <div class="categories-grid" id="player1Categories">
                        <!-- Categories will be populated by JavaScript -->
                    </div>
                    <div class="score-section">
                        <div class="current-score">
                            <span>Score: </span>
                            <span id="player1CurrentScore">0</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="player-side" id="player2Side">
                <div class="player-header">
                    <h3 id="player2Name">Player 2</h3>
                    <div class="player-status" id="player2Status">Waiting...</div>
                </div>
                <div class="player-game-area">
                    <div class="state-display">
                        <div id="player2StateFlag" class="state-flag">ğŸŒ¤ï¸</div>
                        <div id="player2StateName" class="state-name">Waiting for roll...</div>
                    </div>
                    <div class="roll-section">
                        <button id="player2RollBtn" class="btn btn-primary btn-large" disabled>ğŸ² Roll for State</button>
                    </div>
                    <div class="categories-grid" id="player2Categories">
                        <!-- Categories will be populated by JavaScript -->
                    </div>
                    <div class="score-section">
                        <div class="current-score">
                            <span>Score: </span>
                            <span id="player2CurrentScore">0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Round Complete Modal -->
        <div id="roundCompleteModal" class="modal">
            <div class="modal-content">
                <h2>ğŸ‰ Round Complete!</h2>
                <div class="round-results">
                    <div class="player-result">
                        <span id="roundWinnerName"></span> wins this round!
                    </div>
                    <div class="final-scores">
                        <div>Final Scores:</div>
                        <div id="roundFinalScores"></div>
                    </div>
                </div>
                <div class="modal-buttons">
                    <button id="nextRoundBtn" class="btn btn-primary">Next Round</button>
                </div>
            </div>
        </div>
        
        <!-- Game Complete Modal -->
        <div id="gameCompleteModal" class="modal">
            <div class="modal-content">
                <h2>ğŸ† Series Complete!</h2>
                <div class="series-winner">
                    <div id="seriesWinnerName"></div>
                    <div id="seriesFinalScore"></div>
                </div>
                <div class="modal-buttons">
                    <button id="playAgainBtn" class="btn btn-primary">Play Again</button>
                    <button id="backToLobbyBtn" class="btn btn-secondary">Back to Lobby</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Screen -->
    <div id="loadingScreen" class="screen">
        <div class="loading-content">
            <div class="loading-spinner">ğŸŒ¤ï¸</div>
            <h2>Loading Weather Data...</h2>
        </div>
    </div>

    <!-- Score History / Leaderboard Modal (moved outside hidden screens) -->
    <div id="scoreHistoryModal" class="modal">
        <div class="modal-content">
            <h2>ğŸ“Š Score History</h2>
            <div id="scoreHistoryList"></div>
            <button id="closeHistoryBtn" class="btn btn-primary">Close</button>
        </div>
    </div>

                  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
              <script src="config.js"></script>
              <script src="data.js"></script>
              <script src="multiplayer.js"></script>
              <script src="script.js"></script>
</body>
</html>
